<style>
    .search-wrapper {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 3%;
        width: 100%; 
        max-width: 400px; 
        position: relative; 
        margin: 0 auto; 
    }
    
    .search-container.open {
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
    }
    
    .search-container {
        display: flex;
        align-items: center;
        width: 100%;
        background: linear-gradient(135deg, #6a5acd, #aca9e8);
        padding: 8px;
        border-radius: 50px;
        box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.2);
        position: relative;
        border: 1px solid #005670;
        transition: background-color 0.3s ease, border-radius 0.3s ease;
        height: 40px;
    }
    
    .search-input {
        border: none;
        outline: none;
        padding: 8px;
        font-size: 0.9em;
        border-radius: 50px;
        width: 100%;
        background: transparent;
        color: white; /
    }
    
    .search-input::placeholder {
        color: rgba(255, 255, 255, 0.7); 
    }
    
    .search-button {
        background-color: #000000; 
        border: none;
        padding: 0%;
        border-radius: 50%;
        cursor: pointer;
        width: 40px;
        height: 36px;
        display: flex;
        justify-content: center;
        align-items: center;
        transition: 0.3s;
        font-size: 1em;
        color: white;
        box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
    }
    
    .search-button:hover {
        background-color: #999796; 
        box-shadow: 6px 6px 12px rgba(0, 0, 0, 0.3);
    }
    
    .search-results {
        position: absolute;
        top: 100%;
        left: 0;
        width: 100%;
        background-color: #ffffff;
        border-radius: 10px 10px 20px 20px;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
        max-height: 0; 
        overflow-y: hidden;
        opacity: 0;
        transform: translateY(-10px);
        transition: opacity 0.3s ease, transform 0.3s ease, max-height 0.3s ease;
        max-width: 88.3%;
        border: 1px solid #0078a0;
    }
    
    .search-results.open {
        max-height: 300px; 
        opacity: 1;
        transform: translateY(0);
        overflow-y: auto; 
    }
    
    .search-container, .search-results, .result-item {
        transition: background-color 0.3s ease;
    }
    
    
    
    .result-item {
        padding: 10px;
        display: flex;
        align-items: center;
        cursor: pointer;
        border-bottom: 1px solid #ddd;
        transition: background-color 0.2s;
        background-color: #f0f8ff; 
    }
    
    .result-item:hover {
        background-color: #d4edff; 
    }
    
    .result-item img {
        border-radius: 50%;
        margin-right: 10px;
        width: 40px; 
        height: 40px; 
    }
    
    @media (max-width: 768px) {
        .search-wrapper {
            max-width: 90%;
        }
    
        .search-container {
            padding: 6px;
        }
    
        .search-input {
            font-size: 0.8em;
            padding: 6px;
        }
    
        .search-button {
            width: 32px;
            height: 32px;
            font-size: 0.9em;
        }
    
        .result-item img {
            width: 35px;
            height: 35px;
        }
    }
    
    @media (max-width: 480px) {
        .search-wrapper {
            max-width: 100%;
        }
    
        .search-container {
            border-radius: 25px;
        }
    
        .search-input {
            font-size: 0.75em;
        }
    
        .search-button {
            width: 30px;
            height: 30px;
        }
    }
    
    </style>
    <script>
    document.addEventListener("DOMContentLoaded", () => {
        const searchContainer = document.getElementById("searchContainer");
        const searchInput = document.getElementById("searchInput");
        const searchToggle = document.getElementById("searchToggle");
        const resultsContainer = document.getElementById("results");
    
    
        function toggleSearch() {
            searchContainer.classList.toggle("open");
            if (searchContainer.classList.contains("open")) {
                searchInput.focus(); 
            } else {
                searchInput.value = ""; 
                resultsContainer.classList.remove("open");
            }
        }
    
    
        searchToggle.addEventListener("click", toggleSearch);
    
    
        document.addEventListener("click", (event) => {
            if (!searchContainer.contains(event.target) && !searchToggle.contains(event.target)) {
                searchContainer.classList.remove("open");
                resultsContainer.classList.remove("open");
            }
        });
    
     
        document.addEventListener("keydown", (event) => {
            if (event.key === "Escape") {
                searchContainer.classList.remove("open");
                resultsContainer.classList.remove("open");
            }
        });
    
    
        searchInput.addEventListener("input", async () => {
            const query = searchInput.value.trim();
            resultsContainer.innerHTML = "";
            resultsContainer.classList.remove("open");
    
            if (query === "") return;
    
            try {
                const response = await fetch(`/buscar?q=${query}`);
                const users = await response.json();
    
                if (users.length === 0) {
                    resultsContainer.innerHTML = "<p class='text-center p-2'>No se encontraron usuarios</p>";
                } else {
                    users.forEach(user => {
                        const userElement = document.createElement("div");
                        userElement.classList.add("result-item");
                        userElement.innerHTML = `
                            <img src="${user.foto || 'https://via.placeholder.com/40'}" class="me-2" width="40">
                            <span>${user.nombre} ${user.apellido} (@${user.username})</span>
                        `;
                        userElement.onclick = () => window.location.href = `/perfil/${user.username}`;
                        resultsContainer.appendChild(userElement);
                    });
                }
                resultsContainer.classList.add("open");
            } catch (error) {
                console.error("Error al buscar usuarios:", error);
            }
        });
    });
    </script>

        <!-- Llamada al menu -->
        <section data-bs-version="5.1" class="menu menu2 cid-u6ZF78ROEn" once="menu" id="menu-5-u6ZF78ROEn">
            <nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg">
                <div class="container">
                    <div class="navbar-brand">
                        <span class="navbar-logo">
                            <a href="/dashboard">
                                <img src="assets/images/mbr-206x191.png" alt="Mobirise Website Builder" style="height: 4.3rem;">
                            </a>
                        </span>
                        <span class="navbar-caption-wrap"><a class="navbar-caption text-black display-4" href="/dashboard">socialTernero</a></span>
                    </div>
    
    <!-- Barra de b√∫squeda -->
    <div class="search-wrapper">
        <div class="search-container" id="searchContainer">
            <input type="text" class="search-input" id="searchInput" placeholder="Buscar usuarios..." aria-label="Buscar">
        </div>
        <button class="search-button" id="searchToggle" type="button">üîç</button>
        <div class="search-results" id="results"></div>
    </div>
    
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav nav-dropdown" data-app-modern-menu="true">
                            <li class="nav-item">
                                <a class="nav-link link text-black text-primary display-4" href="/perfil">Mi perfil</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link link text-black text-primary display-4" href="/comentarios">Ver mis comentarios</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link link text-black text-primary display-4" href="/publicaciones">Publicaciones</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link link text-black text-primary display-4" href="/logout" aria-expanded="false">logout, <%= username %></a>
                            </li>
                        </ul>
        
                    </div>
                </div>
            </nav>
        </section>